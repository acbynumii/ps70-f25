<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="../styles.css" />
  <title>PS70: Week 5 - 3D Design, Printing, Scanning</title>
</head>
<body>
  <!-- NAVBAR -->
  <nav>
    <div class="left">
      <a href="/">PS70 Fall 2025</a>
    </div>
    <div class="right">
      <a href="/index.html">About Me</a>
      <a href="../final-project.html">Final Project</a>
    </div>
  </nav>

  <main>
    <section class="hero-section">
      <div class="text">
        <h1>Week 5: 3D Design, Printing, Scanning</h1>
        <p>For this week I designed and printed a part, embedded an online STL viewer from Fusion, and captured a scan using RevoScan to view as an OBJ model. I also drafted a template for my final project details, including a 3D model, bill of materials, and timeline.</p>
      </div>
    </section>

    <section class="content-section" id="design-print">
      <h2>Design &amp; Print</h2>
      <p>Brief description of the design intent, constraints (tolerances, overhangs, support strategy), and printing parameters (material, layer height, infill, nozzle, orientation).</p>
      <div class="media-frame">
        <img src="../images/week5_print.webp" alt="Printed part photo (replace with your image)">
      </div>
      <p><em>Tip:</em> Replace the image with your print photo at <code>images/week5_print.webp</code>.</p>
    </section>

    <section class="content-section" id="stl-viewer">
      <h2>Fusion STL Viewer</h2>
      <p>Embed of the Fusion-hosted STL viewer. Paste your Fusion share/embed URL below.</p>
      <div class="embed-container">
        <!-- Replace the src with your Fusion embed/share URL -->
        <iframe src="" allowfullscreen title="Fusion STL Viewer"></iframe>
      </div>
      <p><em>Tip:</em> In Fusion, Share &gt; Public Link &gt; Copy embed code, then paste into the iframe <code>src</code>.</p>
    </section>

    <section class="content-section" id="obj-viewer">
      <h2>3D Scan Viewer (.obj)</h2>
      <p>OBJ model exported from RevoScan. Update the path in the script to your file, e.g., <code>../assets/scan.obj</code>.</p>
      <div id="obj-viewer-container"></div>
      <p><em>Note:</em> If you also have materials (<code>.mtl</code>), consider converting to <code>.glb</code> for best web viewing.</p>
    </section>

    <section class="content-section" id="final-project">
      <h2>Final Project Template</h2>

      <h3>Finalized 3D Model</h3>
      <div class="embed-container">
        <!-- Replace src with the viewer URL for your final model (Fusion/Sketchfab/etc.) -->
        <iframe src="" allowfullscreen title="Final Project 3D Model"></iframe>
      </div>

      <h3>Bill of Materials</h3>
      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Source/Link</th>
            <th>Est. Cost</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Microcontroller</td>
            <td>1</td>
            <td><a href="#">—</a></td>
            <td>$—</td>
            <td>Main control board</td>
          </tr>
          <tr>
            <td>Servo motor</td>
            <td>2</td>
            <td><a href="#">—</a></td>
            <td>$—</td>
            <td>Wrist/Gripper actuation</td>
          </tr>
          <tr>
            <td>Power supply</td>
            <td>1</td>
            <td><a href="#">—</a></td>
            <td>$—</td>
            <td>12V/5V rails</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="3">Total</td>
            <td>$—</td>
            <td></td>
          </tr>
        </tfoot>
      </table>

      <h3>Timeline</h3>
      <table>
        <thead>
          <tr>
            <th>Milestone</th>
            <th>Due by</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>CAD finalized</td>
            <td>—</td>
            <td>Parametric checks and assemblies</td>
          </tr>
          <tr>
            <td>Electronics prototyped</td>
            <td>—</td>
            <td>Firmware MVP</td>
          </tr>
          <tr>
            <td>First full build</td>
            <td>—</td>
            <td>Fit, wire management</td>
          </tr>
          <tr>
            <td>Testing &amp; iteration</td>
            <td>—</td>
            <td>Reliability, UX polish</td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>

  <!-- Three.js + loaders for OBJ viewer -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.153/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.153/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.153/examples/js/loaders/OBJLoader.js"></script>
  <script>
    (function initOBJViewer() {
      const container = document.getElementById('obj-viewer-container');
      if (!container) return;

      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x262626);

      const camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
      camera.position.set(2.5, 2.0, 3.0);

      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(container.clientWidth, container.clientHeight);
      renderer.setPixelRatio(window.devicePixelRatio);
      container.appendChild(renderer.domElement);

      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;

      // Lights
      const hemi = new THREE.HemisphereLight(0xffffff, 0x404040, 0.6);
      scene.add(hemi);
      const dir = new THREE.DirectionalLight(0xffffff, 0.8);
      dir.position.set(5, 10, 7);
      scene.add(dir);

      // Grid/floor (subtle)
      const grid = new THREE.GridHelper(10, 10, 0x444444, 0x333333);
      grid.position.y = -0.01;
      scene.add(grid);

      // Load OBJ (update path to your exported model)
      const loader = new THREE.OBJLoader();
      loader.load(
        '../assets/scan.obj',
        function (obj) {
          // Center and scale to a comfortable size
          obj.traverse((child) => {
            if (child.isMesh) {
              child.material.color.set(0xd0d0d0);
            }
          });

          // Compute bounding box
          const box = new THREE.Box3().setFromObject(obj);
          const size = new THREE.Vector3(); box.getSize(size);
          const center = new THREE.Vector3(); box.getCenter(center);

          obj.position.sub(center); // center the model at origin

          const maxDim = Math.max(size.x, size.y, size.z);
          if (maxDim > 0) {
            const scale = 2.0 / maxDim; // scale to ~2 units
            obj.scale.setScalar(scale);
          }

          scene.add(obj);
        },
        function (xhr) {
          // Progress optional
        },
        function (err) {
          const msg = document.createElement('div');
          msg.style.padding = '10px';
          msg.style.textAlign = 'center';
          msg.textContent = 'Could not load OBJ. Update the path in the script.';
          container.appendChild(msg);
        }
      );

      function onResize() {
        const { clientWidth, clientHeight } = container;
        camera.aspect = clientWidth / clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(clientWidth, clientHeight);
      }
      window.addEventListener('resize', onResize);

      (function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
      })();
    })();
  </script>
</body>
</html>
